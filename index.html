<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CampusEase - Complaint Feed</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css">
  <style>
    body {
      background-color: #f8f9fa;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">
      <img src="images/logo.png" alt="CampusEase Logo" width="130">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active"><a class="nav-link" href="#">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Explore</a></li>
        <li class="nav-item"><a class="nav-link" href="#">About</a></li>
      </ul>
      <a href="#" class="btn btn-outline-primary my-2 my-sm-0">Login / Register</a>
    </div>
  </nav>

  <!-- Heading -->
  <div class="text-center my-4">
    <h2>📢 Recent Complaints</h2>
    <p class="text-muted">See what students are reporting across campus</p>
  </div>

  <!-- Feed -->
  <div id="complaint-feed" class="container mb-5"></div>

  <!-- Loader -->
  <div id="loader" class="text-center mb-5" style="display: none;">
    <p>Loading more complaints...</p>
  </div>

  <!-- JavaScript -->
  <script>
    let page = 1;

    const names = ["Ayush_Singh", "Ritika_Mehta", "Ankit_Raj", "Priya_007", "Sarthak_Yadav"];
    const complaints = [
      {
        text: "Benches in Classroom 5 are broken. Can't sit properly.",
        department: "Classroom",
        type: "image",
        media: "images/broken_bench.jpg"
      },
      {
        text: "Mess food had insects today. Totally unacceptable.",
        department: "Mess",
        type: "image",
        media: "images/mess_food.jpg"
      },
      {
        text: "Fans not working in Lab 204. It's too hot during practicals.",
        department: "Lab",
        type: "text"
      },
      {
        text: "Library AC not working again today.",
        department: "Library",
        type: "text"
      },
      {
        text: "Water leakage near washroom in Block A. Dangerous situation.",
        department: "Maintenance",
        type: "image",
        media: "images/water_leak.jpg"
      },
      {
        text: "Sports equipment is broken and not replaced for weeks.",
        department: "Sports Complex",
        type: "image",
        media: "images/broken_sports.jpg"
      },
      {
        text: "No dustbins in the corridor. Cleanliness issue.",
        department: "Maintenance",
        type: "text"
      },
      {
        text: "Washroom lights are flickering continuously. Hard to use.",
        department: "Maintenance",
        type: "text"
      }
    ];

    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function loadMoreComplaints() {
      document.getElementById("loader").style.display = "block";

      setTimeout(() => {
        const feed = document.getElementById("complaint-feed");

        for (let i = 0; i < 3; i++) {
          const user = getRandom(names) + "_" + Math.floor(Math.random() * 1000);
          const complaint = getRandom(complaints);

          let mediaHTML = "";
          if (complaint.type === "image") {
            mediaHTML = `<img src="${complaint.media}" class="img-fluid rounded mb-2" alt="Issue Image">`;
          }

          const card = document.createElement("div");
          card.className = "card mb-4 shadow-sm";
          card.innerHTML = `
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <strong>@${user}</strong><br>
                  <span class="text-muted small">🏷️ ${complaint.department} • ${Math.floor(Math.random() * 6 + 1)} hrs ago</span>
                </div>
              </div>

              <p class="mt-3 mb-2">${complaint.text}</p>
              ${mediaHTML}

              <div class="d-flex justify-content-between mt-2">
                <div>👍 ${Math.floor(Math.random()*30+10)} 💬 ${Math.floor(Math.random()*10)} 🔁 ${Math.floor(Math.random()*3)}</div>
                <div class="text-muted small">#CampusEase</div>
              </div>

              <input type="text" class="form-control mt-2" placeholder="Add your comment... (Login to reply)" disabled>
            </div>`;
          feed.appendChild(card);
        }

        page++;
        document.getElementById("loader").style.display = "none";
      }, 700);
    }

    window.onscroll = () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) {
        loadMoreComplaints();
      }
    };

    loadMoreComplaints();
  </script>

  <!-- Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>

</body>
</html>
